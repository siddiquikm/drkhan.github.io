<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signos Physician Portal - Share CGM Data with Your Doctor</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- PDF.js for DEXA and Lab report parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    <h1>Signos Physician Portal</h1>
                </div>
                <div class="header-subtitle">Share your CGM data with your healthcare provider</div>
            </div>
            <nav class="header-nav">
                <button class="nav-btn" onclick="openModal('learnMoreModal')">Learn More</button>
                <button class="nav-btn" onclick="openModal('howToUseModal')">How to Use</button>
                <a href="https://refer.signos.com/xtek5h7w" target="_blank" rel="noopener noreferrer" class="nav-btn nav-btn-referral">
                    Get 30% Off Signos
                </a>
            </nav>
            <div class="header-actions">
                <button id="exportPdfBtn" class="btn btn-secondary" disabled>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="12" y1="18" x2="12" y2="12"></line>
                        <line x1="9" y1="15" x2="15" y2="15"></line>
                    </svg>
                    Export PDF
                </button>
            </div>
        </header>

        <!-- Unofficial Disclaimer Banner -->
        <div class="disclaimer-banner">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            <span>This is an independent, community-created tool and is <strong>NOT</strong> affiliated with, endorsed by, or officially supported by Signos, Inc.</span>
        </div>

        <!-- Upload Section -->
        <section id="uploadSection" class="upload-section">
            <div class="upload-card">
                <div class="upload-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                </div>
                <h2>Upload Signos CGM Data</h2>
                <p>Upload your Signos ZIP export or glucose_readings.csv file</p>
                <div class="upload-area" id="dropZone">
                    <input type="file" id="fileInput" accept=".csv,.zip" hidden>
                    <p>Drag and drop your ZIP or CSV file here, or</p>
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                        Browse Files
                    </button>
                    <p class="upload-hint">ZIP files will auto-load glucose and weight data</p>
                </div>

                <!-- Export Instructions -->
                <div class="export-help">
                    <button class="help-toggle" onclick="toggleExportHelp()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        How do I export my Signos data?
                        <svg class="toggle-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="export-instructions" id="exportInstructions">
                        <div class="export-method">
                            <strong>Via Signos App (Recommended):</strong>
                            <ol>
                                <li>Open Signos app → Menu → Settings</li>
                                <li>Tap "Export Data" under General</li>
                                <li>Select the "Email" tab</li>
                                <li>Tap "Export Now"</li>
                                <li>Check your email for the CSV files</li>
                            </ol>
                        </div>
                        <div class="export-method">
                            <strong>Request CSV from Support:</strong>
                            <p>Email <a href="mailto:support@signos.com">support@signos.com</a> and request a CSV export of your raw glucose and activity data.</p>
                        </div>
                        <div class="export-files">
                            <strong>Files needed:</strong>
                            <ul>
                                <li><code>glucose_readings.csv</code> - CGM glucose data (required)</li>
                                <li><code>activity_logs.csv</code> - Weight entries (optional)</li>
                            </ul>
                        </div>
                        <a href="https://support.signos.com/hc/en-us/articles/26157421018772-How-do-I-export-and-download-my-data" target="_blank" rel="noopener noreferrer" class="help-link">
                            View Signos Help Article →
                        </a>
                    </div>
                </div>

                <div class="upload-note">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <span>All data is processed locally in your browser. No data is sent to any server.</span>
                </div>
            </div>
        </section>

        <!-- Dashboard (hidden until data is loaded) -->
        <main id="dashboard" class="dashboard hidden">
            <!-- Patient Info Bar -->
            <section class="patient-info-bar">
                <div class="patient-details">
                    <div class="info-item">
                        <span class="info-label">Data Range</span>
                        <span class="info-value" id="dateRange">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Total Days</span>
                        <span class="info-value" id="totalDays">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Data Coverage</span>
                        <span class="info-value" id="dataCoverage">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Total Readings</span>
                        <span class="info-value" id="totalReadings">-</span>
                    </div>
                </div>
                <button class="btn btn-outline" onclick="resetDashboard()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    Load New Data
                </button>
            </section>

            <!-- Time Period Comparison Selector -->
            <section class="comparison-selector card">
                <h3>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    Time Period Comparison
                </h3>
                <div class="comparison-controls">
                    <div class="quick-select">
                        <label>Quick Select:</label>
                        <div class="btn-group">
                            <button class="btn btn-sm" data-period="week" onclick="selectPeriod('week')">Week</button>
                            <button class="btn btn-sm" data-period="month" onclick="selectPeriod('month')">Month</button>
                            <button class="btn btn-sm" data-period="quarter" onclick="selectPeriod('quarter')">Quarter</button>
                            <button class="btn btn-sm active" data-period="all" onclick="selectPeriod('all')">All Data</button>
                        </div>
                    </div>
                    <div class="custom-range">
                        <div class="range-group">
                            <label>Current Period:</label>
                            <input type="date" id="currentStart" class="date-input">
                            <span>to</span>
                            <input type="date" id="currentEnd" class="date-input">
                        </div>
                        <div class="range-group">
                            <label>Compare To:</label>
                            <input type="date" id="compareStart" class="date-input">
                            <span>to</span>
                            <input type="date" id="compareEnd" class="date-input">
                        </div>
                        <button class="btn btn-primary" onclick="applyComparison()">Compare</button>
                    </div>
                </div>
            </section>

            <!-- Key Metrics Cards -->
            <section class="metrics-grid">
                <div class="metric-card" id="avgGlucoseCard">
                    <div class="metric-header">
                        <span class="metric-title">Average Glucose</span>
                        <span class="metric-change" id="avgGlucoseChange"></span>
                    </div>
                    <div class="metric-value" id="avgGlucose">-</div>
                    <div class="metric-unit">mg/dL</div>
                    <div class="metric-status" id="avgGlucoseStatus"></div>
                    <div class="metric-target">Target: 79-100 mg/dL</div>
                    <div class="metric-comparison" id="avgGlucoseCompare"></div>
                </div>

                <div class="metric-card" id="variabilityCard">
                    <div class="metric-header">
                        <span class="metric-title">Glucose Variability (CV)</span>
                        <span class="metric-change" id="variabilityChange"></span>
                    </div>
                    <div class="metric-value" id="variability">-</div>
                    <div class="metric-unit">%</div>
                    <div class="metric-status" id="variabilityStatus"></div>
                    <div class="metric-target">Target: &lt;36%</div>
                    <div class="metric-comparison" id="variabilityCompare"></div>
                </div>

                <div class="metric-card" id="tirCard">
                    <div class="metric-header">
                        <span class="metric-title">Time in Optimal Range</span>
                        <span class="metric-change" id="tirChange"></span>
                    </div>
                    <div class="metric-value" id="tir">-</div>
                    <div class="metric-unit">%</div>
                    <div class="metric-status" id="tirStatus"></div>
                    <div class="metric-target">Target: 70-110 mg/dL, &gt;70%</div>
                    <div class="metric-comparison" id="tirCompare"></div>
                </div>

                <div class="metric-card" id="fastingCard">
                    <div class="metric-header">
                        <span class="metric-title">Fasting Glucose</span>
                        <span class="metric-change" id="fastingChange"></span>
                    </div>
                    <div class="metric-value" id="fasting">-</div>
                    <div class="metric-unit">mg/dL</div>
                    <div class="metric-status" id="fastingStatus"></div>
                    <div class="metric-target">Target: 70-99 mg/dL</div>
                    <div class="metric-comparison" id="fastingCompare"></div>
                </div>
            </section>

            <!-- Time in Range Breakdown -->
            <section class="card tir-section">
                <h3>Time in Range Distribution</h3>
                <div class="tir-content">
                    <div class="tir-chart-container">
                        <canvas id="tirChart"></canvas>
                    </div>
                    <div class="tir-legend">
                        <div class="tir-legend-item">
                            <span class="tir-color tir-high"></span>
                            <span class="tir-label">High (&gt;140 mg/dL)</span>
                            <span class="tir-value" id="tirHigh">-</span>
                        </div>
                        <div class="tir-legend-item">
                            <span class="tir-color tir-elevated"></span>
                            <span class="tir-label">Elevated (110-140 mg/dL)</span>
                            <span class="tir-value" id="tirElevated">-</span>
                        </div>
                        <div class="tir-legend-item">
                            <span class="tir-color tir-optimal"></span>
                            <span class="tir-label">Optimal (70-110 mg/dL)</span>
                            <span class="tir-value" id="tirOptimal">-</span>
                        </div>
                        <div class="tir-legend-item">
                            <span class="tir-color tir-low"></span>
                            <span class="tir-label">Low (&lt;70 mg/dL)</span>
                            <span class="tir-value" id="tirLow">-</span>
                        </div>
                    </div>
                </div>
                <div class="tir-comparison" id="tirComparisonBars"></div>
            </section>

            <!-- AGP Chart -->
            <section class="card agp-section">
                <div class="section-header">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                        24-Hour Glucose Profile (AGP)
                    </h3>
                    <div class="agp-legend">
                        <span class="legend-item"><span class="legend-line solid"></span> Median</span>
                        <span class="legend-item"><span class="legend-area dark"></span> 25th-75th %ile</span>
                        <span class="legend-item"><span class="legend-area light"></span> 10th-90th %ile</span>
                    </div>
                </div>
                <div class="agp-chart-container">
                    <canvas id="agpChart"></canvas>
                </div>
                <div class="agp-context">
                    <div class="context-item">
                        <span class="context-icon optimal"></span>
                        <span>Optimal Range (70-110 mg/dL) - Ideal for metabolic health and weight loss</span>
                    </div>
                    <div class="context-item">
                        <span class="context-icon elevated"></span>
                        <span>Elevated Range (110-140 mg/dL) - May trigger increased insulin response</span>
                    </div>
                </div>
            </section>

            <!-- Daily Patterns -->
            <section class="card daily-section">
                <h3>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Daily Glucose Patterns
                </h3>
                <div class="daily-chart-container">
                    <canvas id="dailyChart"></canvas>
                </div>
            </section>

            <!-- Long-term Progress -->
            <section class="card progress-section">
                <div class="section-header">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                            <polyline points="17 6 23 6 23 12"></polyline>
                        </svg>
                        Long-Term Progress
                    </h3>
                    <div class="progress-metric-selector">
                        <label>Show:</label>
                        <select id="progressMetric" onchange="updateProgressChart()">
                            <option value="avgGlucose">Average Glucose</option>
                            <option value="cv">Glucose Variability (CV%)</option>
                            <option value="tir">Time in Optimal Range</option>
                            <option value="fasting">Fasting Glucose</option>
                        </select>
                    </div>
                </div>
                <div class="progress-chart-container">
                    <canvas id="progressChart"></canvas>
                </div>
            </section>

            <!-- Improvement Summary Table -->
            <section class="card summary-section">
                <h3>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Improvement Summary
                </h3>
                <div class="summary-table-container">
                    <table class="summary-table">
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>First Week</th>
                                <th>Previous Period</th>
                                <th>Current Period</th>
                                <th>Overall Change</th>
                            </tr>
                        </thead>
                        <tbody id="summaryTableBody">
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Weight Loss Context -->
            <section class="card context-section">
                <h3>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    Understanding Your Metrics for Weight Loss
                </h3>
                <div class="context-grid">
                    <div class="context-card">
                        <h4>Average Glucose</h4>
                        <p>Lower average glucose (79-100 mg/dL) indicates better insulin sensitivity, which helps your body burn fat more efficiently instead of storing it.</p>
                    </div>
                    <div class="context-card">
                        <h4>Glucose Variability (CV)</h4>
                        <p>Lower variability (&lt;36%) means more stable energy levels and fewer hunger cravings. Large glucose swings can trigger overeating and fat storage.</p>
                    </div>
                    <div class="context-card">
                        <h4>Time in Optimal Range</h4>
                        <p>Spending more time in the 70-110 mg/dL range supports metabolic health and indicates your body is efficiently processing carbohydrates.</p>
                    </div>
                    <div class="context-card">
                        <h4>Fasting Glucose</h4>
                        <p>Morning fasting glucose (70-99 mg/dL) reflects overnight metabolic function and insulin sensitivity - key indicators for weight management.</p>
                    </div>
                </div>
            </section>

            <!-- Optional Weight Upload Prompt -->
            <section id="weightUploadPrompt" class="optional-upload-prompt">
                <h4>
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                    Add Weight Data (Optional)
                </h4>
                <p>Upload your activity_logs.csv to see weight trends, health insights, and how they correlate with your glucose data</p>
                <input type="file" id="weightInput" accept=".csv" hidden>
                <button class="btn btn-weight" onclick="document.getElementById('weightInput').click()">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    Upload Activity Log
                </button>
            </section>

            <!-- Weight Section (hidden until weight data loaded) -->
            <section id="weightSection" class="hidden">
                <div class="weight-divider">
                    <span>Weight Progress & Health Insights</span>
                </div>

                <!-- Weight Metrics Cards -->
                <section class="weight-metrics-grid">
                    <div class="weight-metric-card neutral" id="currentWeightCard">
                        <div class="weight-metric-label">Current Weight</div>
                        <div class="weight-metric-value" id="currentWeight">-</div>
                        <div class="weight-metric-unit">lbs</div>
                        <div class="weight-metric-status" id="currentWeightDate">-</div>
                    </div>

                    <div class="weight-metric-card neutral" id="startingWeightCard">
                        <div class="weight-metric-label">Starting Weight</div>
                        <div class="weight-metric-value" id="startingWeight">-</div>
                        <div class="weight-metric-unit">lbs</div>
                        <div class="weight-metric-status" id="startingWeightDate">-</div>
                    </div>

                    <div class="weight-metric-card" id="totalChangeCard">
                        <div class="weight-metric-label">Total Change</div>
                        <div class="weight-metric-value" id="totalChange">-</div>
                        <div class="weight-metric-unit">lbs</div>
                        <div class="weight-metric-change" id="totalChangePercent">-</div>
                    </div>

                    <div class="weight-metric-card" id="weeklyRateCard">
                        <div class="weight-metric-label">Weekly Rate</div>
                        <div class="weight-metric-value" id="weeklyRate">-</div>
                        <div class="weight-metric-unit">lbs/week</div>
                        <div class="weight-metric-change" id="weeklyRateStatus">-</div>
                    </div>
                </section>

                <!-- Weight & Glucose Correlation Chart -->
                <section class="card weight-section">
                    <div class="section-header">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                <polyline points="17 6 23 6 23 12"></polyline>
                            </svg>
                            Weight & Glucose Correlation
                        </h3>
                        <div class="chart-legend-custom">
                            <span class="legend-item-custom">
                                <span class="legend-line-custom" style="background: #059669;"></span>
                                <span class="legend-dash-custom" style="background: linear-gradient(90deg, #059669 50%, transparent 50%); background-size: 8px 2px;"></span>
                                Weight
                            </span>
                            <span class="legend-item-custom">
                                <span class="legend-line-custom" style="background: #2563eb;"></span>
                                <span class="legend-dash-custom" style="background: linear-gradient(90deg, #2563eb 50%, transparent 50%); background-size: 8px 2px;"></span>
                                Avg Glucose
                            </span>
                        </div>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin: -10px 0 20px 0;">
                        See how weight loss correlates with improved glucose control over time
                    </p>
                    <div class="progress-chart-container" style="height: 350px;">
                        <canvas id="weightChart"></canvas>
                    </div>
                    <div class="chart-insight" id="chartInsight"></div>
                </section>

                <!-- Health Insights Dashboard -->
                <section class="card health-insights-section">
                    <div class="section-header">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                            </svg>
                            Health Insights Dashboard
                        </h3>
                        <div class="insights-period" id="insightsPeriod">
                            <span class="period-label">Period:</span>
                            <span class="period-value" id="insightsPeriodValue">All Data</span>
                        </div>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin: -10px 0 24px 0;">
                        Evidence-based metrics derived from your CGM and weight data
                        <span class="period-note" id="periodNote">(min. 14 days for reliable GMI)</span>
                    </p>

                    <!-- Key Metrics Cards -->
                    <div class="insights-grid" id="insightsGrid">
                        <!-- GMI Card -->
                        <div class="insight-card">
                            <div class="insight-card-header">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path d="M12 6v6l4 2"></path>
                                </svg>
                                <span class="insight-card-title">GMI (Est. A1C)</span>
                            </div>
                            <div class="insight-value" id="gmiValue">-</div>
                            <div class="insight-unit">%</div>
                            <div class="insight-status" id="gmiStatus">-</div>
                            <div class="insight-info" id="gmiInfo">Based on avg glucose</div>
                        </div>

                        <!-- CV% Card -->
                        <div class="insight-card">
                            <div class="insight-card-header">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                                </svg>
                                <span class="insight-card-title">Glucose Variability</span>
                            </div>
                            <div class="insight-value" id="cvValueInsight">-</div>
                            <div class="insight-unit">CV%</div>
                            <div class="insight-status" id="cvStatusInsight">-</div>
                            <div class="insight-info">Lower = lower CVD risk</div>
                        </div>

                        <!-- Fasting Glucose Card -->
                        <div class="insight-card">
                            <div class="insight-card-header">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
                                    <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
                                    <line x1="6" y1="1" x2="6" y2="4"></line>
                                    <line x1="10" y1="1" x2="10" y2="4"></line>
                                    <line x1="14" y1="1" x2="14" y2="4"></line>
                                </svg>
                                <span class="insight-card-title">Fasting Glucose</span>
                            </div>
                            <div class="insight-value" id="fastingValueInsight">-</div>
                            <div class="insight-unit">mg/dL</div>
                            <div class="insight-status" id="fastingStatusInsight">-</div>
                            <div class="insight-info">Metabolic syndrome threshold: 100</div>
                        </div>
                    </div>

                    <!-- Disease Risk Reduction -->
                    <div class="risk-reduction-section" id="riskReductionSection">
                        <h4>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22 4 12 14.01 9 11.01"></polyline>
                            </svg>
                            Estimated Disease Risk Reduction
                        </h4>
                        <div id="riskReductionContent">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Pattern Analysis -->
                    <div class="pattern-analysis">
                        <h4>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                            </svg>
                            Pattern Analysis
                        </h4>
                        <div class="pattern-grid" id="patternGrid">
                            <!-- Dawn Phenomenon -->
                            <div class="pattern-item">
                                <div class="pattern-icon" id="dawnIcon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M17 18a5 5 0 0 0-10 0"></path>
                                        <line x1="12" y1="2" x2="12" y2="9"></line>
                                        <line x1="4.22" y1="10.22" x2="5.64" y2="11.64"></line>
                                        <line x1="1" y1="18" x2="3" y2="18"></line>
                                        <line x1="21" y1="18" x2="23" y2="18"></line>
                                        <line x1="18.36" y1="11.64" x2="19.78" y2="10.22"></line>
                                        <line x1="23" y1="22" x2="1" y2="22"></line>
                                        <polyline points="8 6 12 2 16 6"></polyline>
                                    </svg>
                                </div>
                                <div class="pattern-content">
                                    <div class="pattern-title">Dawn Phenomenon</div>
                                    <div class="pattern-value" id="dawnValue">Analyzing...</div>
                                </div>
                            </div>

                            <!-- Post-Meal Spikes -->
                            <div class="pattern-item">
                                <div class="pattern-icon" id="spikeIcon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                        <polyline points="17 6 23 6 23 12"></polyline>
                                    </svg>
                                </div>
                                <div class="pattern-content">
                                    <div class="pattern-title">Post-Meal Spikes</div>
                                    <div class="pattern-value" id="spikeValue">Analyzing...</div>
                                </div>
                            </div>

                            <!-- Time in Optimal Range -->
                            <div class="pattern-item">
                                <div class="pattern-icon" id="tirIcon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                        <line x1="9" y1="9" x2="15" y2="15"></line>
                                        <line x1="15" y1="9" x2="9" y2="15"></line>
                                    </svg>
                                </div>
                                <div class="pattern-content">
                                    <div class="pattern-title">Time in Optimal Range</div>
                                    <div class="pattern-value" id="tirValueInsight">Analyzing...</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Medical Disclaimer -->
                    <div class="medical-disclaimer">
                        <strong>Medical Disclaimer:</strong> These insights are educational estimates based on population-level research.
                        Individual results vary significantly based on genetics, medications, and other health conditions.
                        These are not diagnoses and do not replace professional medical advice.
                        Consult your healthcare provider for personalized guidance.
                    </div>
                </section>

                <!-- Weight Loss Milestones -->
                <section class="card weight-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                        Weight Loss Milestones & Health Benefits
                    </h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 20px;">
                        Clinical benefits increase at each milestone. Based on ADA Standards of Care and clinical research.
                    </p>
                    <div class="milestones-grid" id="milestonesGrid"></div>
                </section>
            </section>

            <!-- Optional DEXA/Lab Upload Prompt -->
            <section id="dexaLabUploadPrompt" class="optional-upload-prompt dexa-lab-prompt">
                <h4>
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    Add Body Composition & Labs (Optional)
                </h4>
                <p>Upload DEXA scan and lab results to unlock comprehensive metabolic health insights, longevity markers, and cardiovascular risk assessment</p>
                <div class="dexa-lab-buttons">
                    <div class="upload-btn-group">
                        <input type="file" id="dexaInput" accept=".pdf" hidden>
                        <button class="btn btn-dexa" onclick="document.getElementById('dexaInput').click()">
                            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="3" y1="9" x2="21" y2="9"></line>
                                <line x1="9" y1="21" x2="9" y2="9"></line>
                            </svg>
                            Upload DEXA Scan
                        </button>
                        <span class="upload-status" id="dexaStatus"></span>
                    </div>
                    <div class="upload-btn-group">
                        <input type="file" id="labInput" accept=".pdf" multiple hidden>
                        <button class="btn btn-lab" onclick="document.getElementById('labInput').click()">
                            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                            </svg>
                            Upload Lab Results
                        </button>
                        <span class="upload-status" id="labStatus"></span>
                    </div>
                </div>
                <p class="upload-hint">Supports DEXA scans from Live Lean Rx, DexaFit, and similar providers. Lab results from Labcorp supported.</p>
            </section>

            <!-- Body Composition & Labs Section (hidden until data loaded) -->
            <section id="bodyCompLabsSection" class="hidden">
                <div class="dexa-lab-divider">
                    <span>Body Composition & Lab Insights</span>
                </div>

                <!-- Metabolic Health Score -->
                <section class="card metabolic-score-section">
                    <div class="section-header">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                            </svg>
                            Metabolic Health Score
                        </h3>
                        <div class="score-badge" id="metabolicScoreBadge">
                            <span class="score-value" id="metabolicScoreValue">--</span>
                            <span class="score-label">/100</span>
                        </div>
                    </div>
                    <p class="section-description">Composite score based on insulin sensitivity, body composition, inflammation, and cardiovascular markers</p>

                    <div class="score-breakdown" id="metabolicScoreContainer">
                        <!-- Populated by JavaScript -->
                    </div>
                </section>

                <!-- DEXA Analysis Section -->
                <section class="card dexa-analysis-section" id="bodyCompMetricsContainer">
                    <!-- DEXA metrics - populated by JavaScript -->
                </section>

                <!-- Body Composition Trends (if multiple DEXA scans) -->
                <section class="card dexa-trends-section hidden" id="dexaTrendsContainer">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                            <polyline points="17 6 23 6 23 12"></polyline>
                        </svg>
                        Body Composition Trends
                    </h3>
                    <div class="dexa-chart-container">
                        <canvas id="dexaTrendsChart"></canvas>
                    </div>
                </section>

                <!-- Lab Biomarkers Dashboard -->
                <section class="card lab-biomarkers-section" id="labBiomarkersSection">
                    <div class="section-header">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                            </svg>
                            Lab Biomarkers
                        </h3>
                        <div class="lab-date-selector" id="labDateSelector">
                            <!-- Populated by JavaScript if multiple lab dates -->
                        </div>
                    </div>

                    <div class="biomarker-categories" id="labBiomarkersContainer">
                        <!-- Populated by JavaScript -->
                    </div>
                </section>

                <!-- Cardiovascular Risk Panel -->
                <section class="card cv-risk-section" id="cvRiskSection">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                        Cardiovascular Risk Assessment
                    </h3>
                    <div class="cv-risk-content" id="cvRiskContainer">
                        <!-- Populated by JavaScript -->
                    </div>
                </section>

                <!-- Longevity Risk Flags -->
                <section class="card longevity-flags-section" id="longevityFlagsSection">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                            <line x1="12" y1="9" x2="12" y2="13"></line>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        Longevity Risk Flags & Recommendations
                    </h3>
                    <div class="longevity-flags-content" id="longevityFlagsContainer">
                        <!-- Populated by JavaScript -->
                    </div>
                </section>

                <!-- CGM-Lab Correlation -->
                <section class="card cgm-lab-correlation-section" id="cgmLabCorrelationSection">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="2" y1="12" x2="22" y2="12"></line>
                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                        </svg>
                        CGM & Lab Data Correlation
                    </h3>
                    <p class="section-description">How your continuous glucose patterns relate to your lab biomarkers</p>
                    <div class="correlation-insights" id="cgmLabCorrelationContainer">
                        <!-- Populated by JavaScript -->
                    </div>
                </section>

                <!-- Generate Report Button -->
                <section class="generate-report-section">
                    <button class="btn btn-primary btn-large" id="generateFullReportBtn" onclick="generateComprehensiveReport()">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                        Generate Comprehensive Health Report (PDF)
                    </button>
                    <p class="report-note">Includes CGM analysis, body composition, lab results, and personalized insights</p>
                </section>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-disclaimer">
                <p><strong>Unofficial Tool:</strong> This portal is an independent, community-created project and is NOT affiliated with, endorsed by, or officially supported by Signos, Inc.</p>
            </div>
            <div class="footer-content">
                <div class="footer-main">
                    <p>Signos Physician Portal | Data processed locally - No information sent to servers</p>
                    <p class="disclaimer">This tool is for informational purposes only. CGM data should be interpreted in consultation with a healthcare provider.</p>
                </div>
                <div class="footer-links">
                    <div class="footer-legal">
                        <a href="privacy.html" target="_blank">Privacy Policy</a>
                        <span class="separator">|</span>
                        <a href="terms.html" target="_blank">Terms of Use</a>
                    </div>
                    <div class="footer-referral">
                        <a href="https://refer.signos.com/xtek5h7w" target="_blank" rel="noopener noreferrer" class="referral-link">
                            New to Signos? Get 30% Off →
                        </a>
                    </div>
                </div>
            </div>
            <div class="footer-copyright">
                <p>Signos® is a registered trademark of Signos, Inc.</p>
                <p class="version-info">Version 2.1.1-beta | Build: 2025-12-24T00:00:00Z | Branch: claude/cgm-portal-requirements-ITM2F</p>
            </div>
        </footer>
    </div>

    <!-- Learn More Modal -->
    <div id="learnMoreModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('learnMoreModal')">&times;</button>
            <h2>What is Signos Physician Portal?</h2>
            <p class="modal-intro">A free, privacy-focused tool that transforms your Signos CGM data into professional reports for your healthcare provider.</p>

            <div class="features-grid">
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                    </div>
                    <h4>AGP Charts</h4>
                    <p>Industry-standard Ambulatory Glucose Profile showing your 24-hour glucose patterns with percentile bands.</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                            <polyline points="17 6 23 6 23 12"></polyline>
                        </svg>
                    </div>
                    <h4>Weight Loss Metrics</h4>
                    <p>Unlike diabetes-focused reports, we use the tighter 70-110 mg/dL optimal range for metabolic health.</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </div>
                    <h4>Long-Term Tracking</h4>
                    <p>See glucose trends over weeks, months, and quarters with automatic comparisons.</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                        </svg>
                    </div>
                    <h4>100% Private</h4>
                    <p>All data processing happens in your browser. Nothing is uploaded to any server.</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>
                    <h4>Health Insights</h4>
                    <p>Estimated A1C (GMI), cardiovascular risk indicators, disease risk reduction, and pattern analysis.</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                    </div>
                    <h4>PDF Export</h4>
                    <p>Generate professional reports to share with your physician via email or patient portal.</p>
                </div>
            </div>

            <div class="modal-section">
                <h3>Why Use This Portal?</h3>
                <div class="benefits-columns">
                    <div class="benefits-column">
                        <h4>For Patients</h4>
                        <ul>
                            <li>Show your physician objective metabolic health data</li>
                            <li>Track progress between appointments</li>
                            <li>Understand how lifestyle affects blood sugar</li>
                            <li>Get evidence-based health insights</li>
                        </ul>
                    </div>
                    <div class="benefits-column">
                        <h4>For Physicians</h4>
                        <ul>
                            <li>Receive standardized AGP reports</li>
                            <li>See metabolic context for weight loss patients</li>
                            <li>Review trends without Signos app access</li>
                            <li>Save time with pre-analyzed data</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="modal-disclaimer">
                <p><strong>Note:</strong> This is an independent, community-created tool and is NOT affiliated with Signos, Inc.</p>
            </div>
        </div>
    </div>

    <!-- How to Use Modal -->
    <div id="howToUseModal" class="modal">
        <div class="modal-content modal-content-large">
            <button class="modal-close" onclick="closeModal('howToUseModal')">&times;</button>
            <h2>How to Use This Portal</h2>

            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchTab('patient')">For Patients</button>
                    <button class="tab-btn" onclick="switchTab('physician')">For Physicians</button>
                </div>

                <!-- Patient Guide -->
                <div id="patientTab" class="tab-content active">
                    <div class="guide-section">
                        <h3>Step 1: Export Your Data from Signos</h3>
                        <ol>
                            <li>Open the Signos app on your phone</li>
                            <li>Go to <strong>Menu → Settings → Export Data</strong></li>
                            <li>Select "Email" tab and tap "Export Now"</li>
                            <li>Check your email for the data files</li>
                        </ol>
                        <p class="guide-tip">Alternatively, email <a href="mailto:support@signos.com">support@signos.com</a> to request a CSV export.</p>
                    </div>

                    <div class="guide-section">
                        <h3>Step 2: Upload Your Data</h3>
                        <ol>
                            <li>Click "Browse Files" or drag your <code>glucose_readings.csv</code></li>
                            <li>Wait for the dashboard to load</li>
                            <li>(Optional) Upload <code>activity_logs.csv</code> for weight tracking</li>
                        </ol>
                    </div>

                    <div class="guide-section">
                        <h3>Step 3: Review Your Results</h3>
                        <ul>
                            <li>Check your key metrics at the top</li>
                            <li>Review the AGP chart for daily patterns</li>
                            <li>Look at long-term progress trends</li>
                            <li>Explore health insights (if weight data uploaded)</li>
                        </ul>
                    </div>

                    <div class="guide-section">
                        <h3>Step 4: Share with Your Physician</h3>
                        <ol>
                            <li>Click "Export PDF" to generate a report</li>
                            <li>Email the PDF to your doctor's office</li>
                            <li>Upload to your patient portal, or</li>
                            <li>Bring a printed copy to your appointment</li>
                        </ol>
                    </div>

                    <div class="guide-tips">
                        <h4>Tips for Your Appointment</h4>
                        <ul>
                            <li>Export 2-4 weeks of data before your visit</li>
                            <li>Note any patterns you've observed</li>
                            <li>Prepare questions about your results</li>
                        </ul>
                    </div>
                </div>

                <!-- Physician Guide -->
                <div id="physicianTab" class="tab-content">
                    <div class="guide-section">
                        <h3>Understanding the Context</h3>
                        <p>This portal is designed for <strong>weight loss patients</strong> using Signos CGM, not diabetes management. Metrics use tighter targets optimized for metabolic health.</p>
                    </div>

                    <div class="guide-section">
                        <h3>Key Metrics Explained</h3>
                        <table class="metrics-table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Weight Loss Target</th>
                                    <th>Clinical Significance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Average Glucose</td>
                                    <td>79-100 mg/dL</td>
                                    <td>Insulin sensitivity indicator</td>
                                </tr>
                                <tr>
                                    <td>CV%</td>
                                    <td>&lt;36% (ideal &lt;18%)</td>
                                    <td>Glycemic stability</td>
                                </tr>
                                <tr>
                                    <td>Time in Range</td>
                                    <td>&gt;70% in 70-110</td>
                                    <td>Metabolic health</td>
                                </tr>
                                <tr>
                                    <td>Fasting Glucose</td>
                                    <td>70-99 mg/dL</td>
                                    <td>Morning metabolic function</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="guide-section">
                        <h3>AGP Chart Interpretation</h3>
                        <ul>
                            <li><strong>Median line:</strong> Typical glucose throughout the day</li>
                            <li><strong>Dark band (25-75th %ile):</strong> Most common glucose range</li>
                            <li><strong>Light band (10-90th %ile):</strong> Includes occasional variations</li>
                            <li><strong>Meal response zones:</strong> Look for post-meal peaks</li>
                        </ul>
                    </div>

                    <div class="guide-section">
                        <h3>Health Insights (If Weight Data Included)</h3>
                        <ul>
                            <li><strong>GMI:</strong> Estimates A1C from CGM mean glucose (Formula: 3.31 + 0.02392 × mean glucose)</li>
                            <li><strong>Risk Reduction:</strong> Based on weight loss percentage (16% T2D risk reduction per kg lost)</li>
                            <li><strong>Dawn Phenomenon:</strong> Early morning glucose rise &gt;20 mg/dL indicates insulin resistance</li>
                        </ul>
                    </div>

                    <div class="guide-section">
                        <h3>Clinical Recommendations by Pattern</h3>
                        <table class="metrics-table">
                            <thead>
                                <tr>
                                    <th>Pattern</th>
                                    <th>Possible Intervention</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>High fasting glucose</td>
                                    <td>Evening meal timing, protein-rich dinner</td>
                                </tr>
                                <tr>
                                    <td>Large post-meal spikes</td>
                                    <td>Food pairing, meal composition</td>
                                </tr>
                                <tr>
                                    <td>High variability</td>
                                    <td>Consistent meal timing, portion control</td>
                                </tr>
                                <tr>
                                    <td>Dawn phenomenon</td>
                                    <td>Evening exercise, earlier dinner</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="guide-section">
                        <h3>Data Quality Notes</h3>
                        <ul>
                            <li>10-14 days minimum for reliable GMI</li>
                            <li>More data = more reliable patterns</li>
                            <li>Consider patient's context (illness, travel, etc.)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
